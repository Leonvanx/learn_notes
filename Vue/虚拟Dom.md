虚拟DOM的核心逻辑是通过JavaScript对象模拟真实DOM结构，在数据变更时生成新的虚拟DOM树，通过**Diff算法**比对差异，最后仅更新真实DOM中变化的部分。虚拟 DOM 的主要好处包括以下几点：

1. **性能优化**：真实 DOM 操作通常是昂贵的，因为直接操作真实 DOM 会触发浏览器的重绘和重排。虚拟 DOM 可以在内存中进行操作，减少了直接操作真实 DOM 的次数，通过批量更新和最小化操作来提高性能。
2. **跨平台开发**：虚拟 DOM 的抽象层使得前端框架可以轻松地适配不同平台和环境，例如浏览器、移动端、桌面应用等。开发者可以使用相同的代码结构来构建不同平台的应用程序。
3. **方便的状态管理**：虚拟 DOM 通常与组件化开发相结合，通过将 UI 拆分成独立的组件，并使用响应式数据管理状态，使得应用的状态管理更加清晰和简单。当状态发生变化时，虚拟 DOM 可以智能地比较前后状态的差异，并只更新发生变化的部分，从而减少不必要的重新渲染。
4. **简化复杂度**：虚拟 DOM 提供了一种抽象层，使得前端开发者可以更专注于应用的逻辑和功能实现，而不需要过多地关注底层的 DOM 操作。这种抽象使得开发过程更加简化和高效。

总的来说，虚拟 DOM 技术在前端开发中发挥着重要作用，它通过性能优化、跨平台开发、方便的状态管理以及简化复杂度等方面为开发者提供了诸多好处，使得现代前端应用的开发更加高效和可靠。

虚拟 DOM 的工作流程通常可以分为以下几个步骤：

1. **初始渲染**：
   - 首先，应用初始化时，会通过虚拟 DOM 创建一个内存中的 DOM 树，该树结构与实际的 DOM 结构一一对应。
2. **状态变更**：
   - 当应用的状态发生改变时（例如用户交互或数据更新），框架会生成一个新的虚拟 DOM 树，表示更新后的 UI 状态。
3. **虚拟 DOM 比较**：
   - 框架会将更新后的虚拟 DOM 树与之前的虚拟 DOM 树进行比较，找出两者之间的差异。这个过程通常被称为虚拟 DOM 的 diff（差异）算法。
4. **生成 DOM 更新操作**：
   - 根据差异，框架会生成一组 DOM 更新操作，用于将实际的 DOM 结构更新为与新的虚拟 DOM 树对应的结构。这些操作可以包括添加、删除、移动或更新 DOM 元素等。
5. **批量更新 DOM**：
   - 一般情况下，框架会将所有的 DOM 更新操作批量执行，以减少 DOM 操作的次数，提高性能。
6. **实际 DOM 更新**：
   - 最后，框架会将这些 DOM 更新操作应用到实际的 DOM 结构上，完成页面的更新。

通过这个流程，虚拟 DOM 技术可以实现高效的页面更新，避免了直接操作实际 DOM 带来的性能损耗，同时确保了页面的正确性和一致性。这种方式也使得前端开发者可以更加专注于应用的逻辑和功能实现，而不必过多地关注底层的 DOM 操作。

Vue 从建立 DOM 树到页面渲染的过程可以概括为以下几个步骤：

1. **解析模板（Template Parsing）**：
   Vue 会将模板解析为虚拟 DOM 树。这个过程包括将模板中的指令、表达式等解析为相应的操作，以及建立虚拟 DOM 树的结构。
2. **依赖收集（Dependency Collection）**：
   在解析模板的过程中，Vue 会识别出模板中的数据依赖关系。对于计算属性和响应式数据，Vue 会建立依赖关系，以便在数据变化时能够通知相关的依赖进行更新。
3. **初始化渲染（Initial Rendering）**：
   Vue 首次渲染页面时，会执行一次初始渲染过程。这个过程会根据虚拟 DOM 树以及响应式数据的当前状态，生成真实 DOM，并插入到页面中。同时，Vue 会对响应式数据进行监听，以便在数据发生变化时能够重新渲染页面。
4. **监听数据变化（Listening for Data Changes）**：
   Vue 会监听响应式数据的变化。当数据发生变化时，Vue 会通知相关的依赖进行更新，进而重新计算受影响的部分，并执行页面的更新。
5. **虚拟 DOM 更新（Virtual DOM Update）**：
   当数据发生变化时，Vue 会生成新的虚拟 DOM，并通过 Diff 算法将新旧虚拟 DOM 进行比较，找出差异。然后，Vue 会只更新有变化的部分，而不是重新渲染整个页面，以提高性能。
6. **页面渲染（DOM Rendering）**：
   最后，Vue 将更新后的虚拟 DOM 映射到真实的 DOM 上，从而完成页面的渲染。这个过程会更新页面上发生变化的部分，而不会重新渲染整个页面。

总的来说，Vue 通过建立虚拟 DOM、监听数据变化、以及使用 Diff 算法等技术，实现了高效的页面更新和渲染机制，从而提高了 Web 应用的性能和用户体验。

>  key的作用：
>
> 1. key 是为 Vue 中     vnode 的唯一标记，通过这个 key，我们的 diff     操作可以更准确、更快速
>
> 2. 更准确：因为带 key 就不是就地复用了，在     sameNode 函数a.key === b.key对比中可以避免就地复用的情况。所以会更加准确。
>
> 3. 更快速：利用 key 的唯一性生成 map 对象来获取对应节点，比遍历方式更快

